SELECT (SELECT COALESCE(SUM( grs.Charge), '0.00') FROM  grouprespart  grs,  grouphallres ghr WHERE  grs.DNo='601' AND ghr.Dno= grs.DNo AND ghr.active='1') AS grsart_charge,
       (SELECT COALESCE(SUM(ri.Charge), '0.00') FROM  requested_item ri,  creategrpno cgn,grouphallres grs WHERE ri.Reservation_No=cgn.groupNo AND cgn.dNo='601' AND grs.active='1' AND cgn.dNo=grs.Dno AND ri.IsComplementory='0' GROUP BY cgn.resNo) AS requested_item_charge,
       (SELECT COALESCE(SUM(rmd.pax*rmd.chargeWithtAX), 0) FROM  requestedmenudetails rmd,grouphallres ghr,  creategrpno cgn,  grouphallres grouphallr8_ WHERE rmd.DateNo=ghr.Dno AND rmd.reservNo=cgn.resNo AND grouphallr8_.active='1' AND cgn.dNo=grouphallr8_.Dno AND cgn.dNo=rmd.DateNo AND cgn.dNo='601' GROUP BY cgn.resNo) AS requestedmenudetails_chareg,
       (SELECT COALESCE(SUM(er.ChargeWithTax), '0.00') FROM  extra_request er,  creategrpno cgn,  grouphallres grouphallr12_ WHERE er.reserv_No=cgn.groupNo AND cgn.dNo='601' AND er.isComplementory='0' AND grouphallr12_.active='1' AND cgn.dNo=grouphallr12_.Dno GROUP BY cgn.resNo) AS extra_request_charge,
       (SELECT COALESCE(SUM(rp.fullCharge), '0.00') FROM  requestedpackage rp,  creategrpno creategrpn14_,grouphallres grouphallr15_ WHERE rp.reservNo=creategrpn14_.dNo AND creategrpn14_.dNo='601' AND rp.IsComplementory='0' AND grouphallr15_.active='1' AND creategrpn14_.dNo=grouphallr15_.Dno GROUP BY creategrpn14_.resNo) AS requestedpackage_charge,
       (SELECT COALESCE(SUM(hd.Amount), '0.00') FROM  hall_deposit hd WHERE hd.Reservation_No='47' AND hd.reference='601' AND hd.Payment_Method<>3) AS hall_deposit_charge,
       (SELECT COALESCE(SUM(dis.discountAmount), '0.00') FROM  discount dis WHERE dis.resNo='47' AND dis.Dno='601' AND (dis.discountType='T' OR dis.discountType='A' OR dis.discountType='B' OR dis.discountType='C' OR dis.discountType='P'  OR dis.discountType='E')) AS discount,
       (SELECT COALESCE(SUM(rd.refundAmount), '0.00') FROM  refunddetails rd WHERE rd.reservationNo='47' AND rd.reference='601' AND rd.payMethod=3) AS refunddetails_charge,
       (SELECT COALESCE(SUM(hd.Amount), '0.00') FROM  hall_deposit hd WHERE hd.Reservation_No='47' AND hd.reference='601' AND hd.Payment_Method<>3 AND hd.Payment_Method<>2) AS hall_deposit_charge
FROM  grouphallres ghr WHERE ghr.Dno='601' AND ghr.active='1'
